<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="/Png/icon.png">
    <!-- Scripts -->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script
        src="https://unpkg.com/aframe-environment-component@1.5.x/dist/aframe-environment-component.min.js"></script>
    <script src="aframe-physics-system.min.js"></script>
    <script>
        // ==========================
        //   COMPONENTE: Encender ventanas
        // ==========================
        AFRAME.registerComponent('encender-ventanas', {
            init: function () {
                this.encendidas = false;
                this.colorOriginal = null;

                this.luzInterior = null; // ← luz que se creará dentro del edificio

                this.el.addEventListener('click', () => {
                    this.toggleLuces();
                });
            },

            setLuces: function (estado) {
                if (estado === this.encendidas) return;
                this.toggleLuces();
            },

            toggleLuces: function () {
                const mesh = this.el.getObject3D('mesh');
                if (!mesh) return;

                mesh.traverse((node) => {
                    if (node.isMesh && node.name === 'Ventanas') {

                        if (!this.colorOriginal) {
                            this.colorOriginal = node.material.color.clone();
                        }

                        if (this.encendidas) {
                            // APAGAR
                            node.material.color.copy(this.colorOriginal);
                            node.material.emissive.set('#000000');
                            node.material.emissiveIntensity = 0;
                        } else {
                            // ENCENDER
                            node.material.color.set('#FFD700');
                            node.material.emissive.set('#FFD700');
                            node.material.emissiveIntensity = 1.5;
                        }

                        node.material.needsUpdate = true;
                    }
                });

                // ==========================
                //   ENCENDER / APAGAR LUZ INTERIOR
                // ==========================
                if (!this.encendidas) {
                    // Crear luz si no existe
                    this.luzInterior = document.createElement('a-entity');
                    this.luzInterior.setAttribute('light', {
                        type: 'point',
                        color: '#FFD700',
                        intensity: 10,
                        distance: 20
                    });

                    // Posición aproximada dentro del edificio
                    this.luzInterior.setAttribute('position', '4 5 0');

                    this.el.appendChild(this.luzInterior);
                } else {
                    // Eliminar luz al apagar
                    if (this.luzInterior) {
                        this.el.removeChild(this.luzInterior);
                        this.luzInterior = null;
                    }
                }

                this.encendidas = !this.encendidas;
            }
        });

        // ==========================
        //   COMPONENTE: Botón general luces
        // ==========================
        AFRAME.registerComponent('boton-luces', {
            init: function () {
                this.lucesEncendidas = false;

                this.entorno = document.querySelector('#entorno');

                this.el.addEventListener('click', () => {
                    this.lucesEncendidas = !this.lucesEncendidas;

                    // Encender/apagar edificios
                    const casas = document.querySelectorAll('[encender-ventanas]');
                    casas.forEach(casa => {
                        casa.components['encender-ventanas'].setLuces(this.lucesEncendidas);
                    });

                    // Cambiar color del botón
                    this.el.setAttribute('material', 'color',
                        this.lucesEncendidas ? '#FFD700' : '#333');

                    // ==========================
                    //   CAMBIO DE CIELO (DÍA ↔ NOCHE)
                    // ==========================
                    if (this.lucesEncendidas) {
                        // NOCHE
                        this.entorno.setAttribute('environment', {
                            preset: 'starry',        // mantiene tu entorno
                            skyType: 'atmosphere',   // necesario para estrellas
                            lighting: 'dusk',
                            stars: 5000,             // cantidad de estrellas (default del preset)
                            starColor: '#ffffff',
                            horizonColor: '#0a0a0a',
                            skyColor: '#000010',
                            fog: 0.6
                        });
                    } else {
                        // DÍA
                        this.entorno.setAttribute('environment', {
                            preset: 'starry',
                            lighting: 'sunset',
                            skyType: 'color',
                            skyColor: '#88ccee',
                            horizonColor: '#ffffff',
                            stars: 0,        // desactivar estrellas
                            fog: 0.2
                        });
                    }
                });
            }
        });

        // ==========================
        //   COMPONENTE: Rotar cartel
        // ==========================
        AFRAME.registerComponent('rotar-cartel', {
            schema: {
                speed: { type: 'number', default: 30 } // grados por segundo
            },

            init: function () {
                this.cartelNode = null;

                this.el.addEventListener('model-loaded', () => {
                    const mesh = this.el.getObject3D('mesh');
                    if (!mesh) return;

                    // Buscar el nodo Cartel sin filtrar por tipo
                    mesh.traverse((node) => {
                        if (node.name === 'Cartel') {
                            this.cartelNode = node;
                        }
                    });

                    if (!this.cartelNode) {
                        console.warn("No se encontró un nodo llamado 'Cartel' en este modelo.");
                    }
                });
            },

            tick: function (time, timeDelta) {
                if (!this.cartelNode) return;

                // Velocidad en radianes por milisegundo
                const rad = THREE.MathUtils.degToRad(this.data.speed) * (timeDelta / 1000);

                // Girar sobre su propio eje Y
                this.cartelNode.rotation.y += rad;
            }
        });

        AFRAME.registerComponent('debug-nodos', {
            init: function () {
                this.el.addEventListener('model-loaded', () => {
                    const mesh = this.el.getObject3D('mesh');

                    console.log("Nodos del modelo:");
                    mesh.traverse((node) => {
                        if (node.isMesh || node.isObject3D) {
                            console.log(node.name);
                        }
                    });
                });
            }
        });

        AFRAME.registerComponent('generar-linea-arboles', {
            schema: {
                cantidad: { type: 'number', default: 10 },
                distancia: { type: 'number', default: 5 },
                direccion: { type: 'vec3', default: { x: 0, y: 0, z: 1 } },
            },

            init: function () {
                const sceneEl = this.el.sceneEl;
                const inicio = this.el.getAttribute('position');

                for (let i = 1; i <= this.data.cantidad; i++) {
                    const arbol = document.createElement('a-entity');

                    // Copiar el modelo del árbol original
                    const modelo = this.el.getAttribute('gltf-model');
                    arbol.setAttribute('gltf-model', modelo);

                    // Posición del árbol
                    const posX = inicio.x + this.data.direccion.x * this.data.distancia * i;
                    const posY = inicio.y + this.data.direccion.y * this.data.distancia * i;
                    const posZ = inicio.z + this.data.direccion.z * this.data.distancia * i;
                    arbol.setAttribute('position', `${posX} ${posY} ${posZ}`);

                    // Rotación aleatoria opcional
                    //arbol.setAttribute('rotation', `0 ${Math.random() * 360} 0`);

                    // Escala
                    const escala = this.el.getAttribute('scale');
                    arbol.setAttribute('scale', `${escala.x} ${escala.y} ${escala.z}`);
                    arbol.setAttribute('static-body', 'shape:box');

                    sceneEl.appendChild(arbol);
                }
            }
        });

        AFRAME.registerComponent('generar-linea-lamparas', {
            schema: {
                cantidad: { type: 'number', default: 10 },
                distancia: { type: 'number', default: 5 },
                direccion: { type: 'vec3', default: { x: 0, y: 0, z: 1 } },
            },

            init: function () {
                const sceneEl = this.el.sceneEl;
                const inicio = this.el.getAttribute('position');

                for (let i = 1; i <= this.data.cantidad; i++) {
                    const lampara = document.createElement('a-entity');

                    // Copiar el modelo del árbol original
                    const modelo = this.el.getAttribute('gltf-model');
                    lampara.setAttribute('gltf-model', modelo);

                    // Posición del árbol
                    const posX = inicio.x + this.data.direccion.x * this.data.distancia * i;
                    const posY = inicio.y + this.data.direccion.y * this.data.distancia * i;
                    const posZ = inicio.z + this.data.direccion.z * this.data.distancia * i;
                    lampara.setAttribute('position', `${posX} ${posY} ${posZ}`);

                    // Rotación aleatoria opcional
                    //arbol.setAttribute('rotation', `0 ${Math.random() * 360} 0`);

                    // Escala
                    const escala = this.el.getAttribute('scale');
                    lampara.setAttribute('scale', `${escala.x} ${escala.y} ${escala.z}`);
                    lampara.setAttribute('static-body', 'shape:box');
                    lampara.setAttribute('encender-ventanas', '');


                    sceneEl.appendChild(lampara);
                }
            }
        });

        // ==========================
        //   INTERACCION POKEMONS
        // ==========================
        AFRAME.registerComponent('pokeball-logic', {
            schema: {
                stopDelay: { type: 'number', default: 1500 },
                pokemonDisappearDelay: { type: 'number', default: 1000 },
                shrinkDuration: { type: 'number', default: 700 } // duración de reducción
            },

            init: function () {
                this.el.addEventListener('collide', (e) => {
                    const target = e.detail.body.el;

                    if (target && target.classList.contains('pokemon')) {

                        // EVITAR MULTIPLES CAPTURAS
                        if (target.isCaptured) return;
                        target.isCaptured = true;

                        //─── REPRODUCIR SONIDO DEL POKÉMON ───
                        const soundURL = target.getAttribute('capture-sound');
                        if (soundURL) {
                            const audio = document.createElement('audio');
                            audio.src = soundURL;
                            audio.volume = 1.0;
                            audio.play();
                            audio.addEventListener('ended', () => audio.remove());
                        }

                        // ─── 1. Animación en la pokeball ───
                        this.el.setAttribute('animation-mixer', {
                            clip: 'ArribaAction',
                            loop: 'once',
                            crossFadeDuration: 0,
                            clampWhenFinished: true
                        });

                        // ─── 2. Crear luz temporal en el Pokémon ───
                        const light = document.createElement('a-entity');
                        light.setAttribute('light', {
                            type: 'point',
                            intensity: 10,
                            distance: 5,
                            color: '#f80000'
                        });
                        light.setAttribute('position', '0 2 0');
                        target.appendChild(light);

                        // ─── 3. Cambiar material del Pokémon → emisivo + transparente ───
                        target.object3D.traverse((node) => {
                            if (node.isMesh) {
                                node.originalMaterial = node.material;
                                node.material = new THREE.MeshStandardMaterial({
                                    color: '#f80000',
                                    emissive: new THREE.Color('red'),
                                    emissiveIntensity: 10,
                                    transparent: true,
                                    opacity: 0.5,
                                    roughness: node.originalMaterial.roughness ?? 0.8,
                                    metalness: node.originalMaterial.metalness ?? 0
                                });
                            }
                        });

                        // parar su movimiento ping-pong
                        target.removeAttribute('pingpong-move-smooth');

                        // ─── 4. Tras el tiempo, reducir poco a poco su escala ───
                        setTimeout(() => {

                            const startScale = target.object3D.scale.clone();
                            const duration = this.data.shrinkDuration;
                            const startTime = performance.now();

                            const shrinkTick = (now) => {
                                const elapsed = now - startTime;
                                let t = elapsed / duration;
                                if (t > 1) t = 1;

                                const newScale = 1 - t;
                                target.object3D.scale.set(
                                    startScale.x * newScale,
                                    startScale.y * newScale,
                                    startScale.z * newScale
                                );

                                if (t < 1) {
                                    requestAnimationFrame(shrinkTick);
                                } else {
                                    // ─── 5. Quitar luz y "desactivar" Pokémon ───
                                    if (light.parentElement) light.parentElement.removeChild(light);

                                    target.setAttribute('visible', 'false');
                                    target.setAttribute('position', '0 -5 0');

                                    // ─── 6. Incrementar contador global ───
                                    const counterSystem = this.el.sceneEl.systems['pokemon-counter'];
                                    counterSystem.addCapture();

                                    // ─── 7. Volver animación Idle en la pokeball ───
                                    this.el.setAttribute('animation-mixer', {
                                        clip: 'Idle',
                                        loop: 'repeat'
                                    });
                                }
                            };

                            requestAnimationFrame(shrinkTick);

                        }, this.data.pokemonDisappearDelay);

                        // ─── 8. Detener la pokeball automáticamente ───
                        setTimeout(() => {
                            if (this.el.body) {
                                this.el.body.velocity.set(0, 0, 0);
                                this.el.body.angularVelocity.set(0, 0, 0);
                                this.el.body.sleep();
                            }
                        }, this.data.stopDelay);
                    }
                });
            }
        });

        AFRAME.registerComponent('cursor-grab', {
            init: function () {
                const cameraEl = document.querySelector('#camera');
                this.grabbedBall = null;

                // ────── CLICK PARA COGER ──────
                this.el.addEventListener('click', (e) => {
                    const intersected = e.detail.intersectedEl;
                    if (!intersected || !intersected.classList.contains('clickable')) return;

                    if (!intersected.isGrabbed) {
                        intersected.isGrabbed = true;
                        this.grabbedBall = intersected;

                        // Quitar físicas
                        intersected.removeAttribute('dynamic-body');

                        // Añadir a la cámara para que siga
                        cameraEl.object3D.add(intersected.object3D);
                        intersected.object3D.position.set(0, 0.1, -1);
                        intersected.object3D.rotation.set(0, 1.55, 0);
                    }
                });

                // ────── ESPACIO PARA SOLTAR ──────
                window.addEventListener('keydown', (evt) => {
                    if (evt.code === 'Space' && this.grabbedBall) {
                        const ball = this.grabbedBall;
                        ball.isGrabbed = false;

                        // Guardamos la posición actual de la bola (donde está delante de la cámara)
                        const currentPos = new THREE.Vector3();
                        ball.object3D.getWorldPosition(currentPos);

                        // Quitar de la cámara y añadir al root
                        const sceneObj = document.querySelector('a-scene').object3D;
                        sceneObj.add(ball.object3D);
                        ball.object3D.position.copy(currentPos);

                        // Activar física
                        ball.setAttribute('dynamic-body', 'mass: 1; shape: sphere');

                        // Lanzar hacia adelante + un poco hacia arriba según cámara
                        const cameraObj = cameraEl.object3D;
                        const forward = new THREE.Vector3(0, 0, -1);
                        forward.applyQuaternion(cameraObj.quaternion);
                        forward.normalize().multiplyScalar(5); // fuerza
                        forward.y += 2; // un poco de elevación
                        ball.body.velocity.set(forward.x, forward.y, forward.z);

                        this.grabbedBall = null;
                    }
                });
            }

        });

        // ────── ESPACIO PARA SOLTAR ──────
        window.addEventListener('keydown', (evt) => {
            if (evt.code === 'Space' && this.grabbedBall) {
                const ball = this.grabbedBall;
                ball.isGrabbed = false;

                // Quitar de la cámara y añadir al root
                const sceneObj = document.querySelector('a-scene').object3D;
                sceneObj.add(ball.object3D);

                // Activar física
                ball.setAttribute('dynamic-body', 'mass: 1; shape: sphere');

                // Lanzar hacia adelante según cámara
                const cameraObj = cameraEl.object3D;
                const forward = new THREE.Vector3(0, .5, -1);
                forward.applyQuaternion(cameraObj.quaternion);
                forward.multiplyScalar(5); // fuerza de lanzamiento
                ball.body.velocity.set(forward.x, forward.y + 2, forward.z);

                this.grabbedBall = null;
            }
        });


        AFRAME.registerComponent("damping", {
            schema: {
                linear: { type: "number", default: 0.1 },
                angular: { type: "number", default: 0.1 }
            },

            init: function () {
                const body = this.el.body;
                if (!body) {
                    this.el.addEventListener("body-loaded", () => {
                        this.el.body.linearDamping = this.data.linear;
                        this.el.body.angularDamping = this.data.angular;
                    });
                    return;
                }

                body.linearDamping = this.data.linear;
                body.angularDamping = this.data.angular;
            }
        });

        //------ Suma de pokemon capturados ------
        AFRAME.registerSystem('pokemon-counter', {
            schema: { count: { type: 'int', default: 0 } },

            addCapture: function () {
                this.data.count += 1;
                console.log('Contador: ', this.data.count);
                // Emitimos un evento global con la cantidad
                this.el.sceneEl.emit('pokemonCaptured', { count: this.data.count });
            }
        });

        //-------- Boton subir torre ---------------
        AFRAME.registerComponent('unlock-button', {
            init: function () {
                this.el.setAttribute('material', 'color', 'gray'); // inicialmente bloqueado
                this.el.setAttribute('clickable', ''); // para poder interactuar después

                // Escuchar el evento global
                this.el.sceneEl.addEventListener('pokemonCaptured', (e) => {
                    if (e.detail.count >= 6) {
                        this.el.setAttribute('material', 'color', 'green'); // desbloqueado visualmente
                        this.el.addEventListener('click', this.onClick); // activar interacción
                    }
                });
            },

            onClick: function () {
                console.log('Botón físico pulsado!');
                // Aquí puedes llamar a la función que quieras
            }
        });

        //-------- Movimiento pokemon --------------
        AFRAME.registerComponent('pingpong-move-smooth', {
            schema: {
                start: { type: 'vec3', default: { x: 0, y: 0, z: -5 } },
                end: { type: 'vec3', default: { x: 1, y: 0, z: -10 } },
                speed: { type: 'number', default: 0.05 },      // velocidad de movimiento
                rotSpeed: { type: 'number', default: 0.05 }    // velocidad de rotación
            },
            init: function () {
                this.forward = true; // dirección
                this.state = 'moving'; // 'moving' o 'turning'
                this.target = new THREE.Vector3();
                this.el.object3D.position.copy(this.data.start);
                this.setTarget();
            },
            setTarget: function () {
                const start = new THREE.Vector3(this.data.start.x, this.data.start.y, this.data.start.z);
                const end = new THREE.Vector3(this.data.end.x, this.data.end.y, this.data.end.z);
                this.target.copy(this.forward ? end : start);

                // Calculamos la rotación deseada en Y hacia el objetivo
                const direction = new THREE.Vector3().subVectors(this.target, this.el.object3D.position);
                const yRotation = Math.atan2(direction.x, direction.z);
                this.targetQuat = new THREE.Quaternion().setFromEuler(new THREE.Euler(0, yRotation, 0));
                this.state = 'turning';
            },
            tick: function (time, delta) {
                const obj = this.el.object3D;

                if (this.state === 'turning') {
                    // Girar poco a poco
                    obj.quaternion.slerp(this.targetQuat, this.data.rotSpeed);
                    // Si está casi llegando a la rotación deseada, pasar a mover
                    if (obj.quaternion.angleTo(this.targetQuat) < 0.01) {
                        obj.quaternion.copy(this.targetQuat);
                        this.state = 'moving';
                    }
                } else if (this.state === 'moving') {
                    // Avanzar hacia el objetivo
                    obj.position.lerp(this.target, this.data.speed);
                    // Si llega cerca del objetivo, cambiar de dirección y girar
                    if (obj.position.distanceTo(this.target) < 0.05) {
                        this.forward = !this.forward;
                        this.setTarget();
                    }
                }
            }
        });
    </script>
</head>

<body>
    <a-scene physics="gravity: -9.8; debug: true; restitution: 0.3">
        <!-- Assets -->
        <a-assets>
            <a-asset-item id="CentroPokemon"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/CentroPokemon.glb"></a-asset-item>
            <a-asset-item id="TiendaPokemon"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/TiendaPokemon.glb"></a-asset-item>
            <a-asset-item id="Casa"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Casa1.glb"></a-asset-item>
            <a-asset-item id="Arbol"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Arbol.glb"></a-asset-item>
            <a-asset-item id="Pokeball"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Pokeball.glb"></a-asset-item>
            <a-asset-item id="Teatro"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Teatro.glb"></a-asset-item>
            <a-asset-item id="Gym" src="https://carloslajarasanchez.github.io/Models/PokemonGLT/GYM.glb"></a-asset-item>
            <a-asset-item id="Lago"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Lago.glb"></a-asset-item>
            <a-asset-item id="Mountain"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Mountain.glb"></a-asset-item>
            <a-asset-item id="Mountain2"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Mountain2.glb"></a-asset-item>
            <a-asset-item id="TorreQuemada"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/TorreQuemada.glb"></a-asset-item>
            <a-asset-item id="CasaNorte"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/CasaNorte.glb"></a-asset-item>
            <a-asset-item id="Lampara"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Lampara.glb"></a-asset-item>
            <a-asset-item id="Torre"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Torre.glb"></a-asset-item>
            <a-asset-item id="CartelMadera"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/CartelMadera.glb"></a-asset-item>
            <a-asset-item id="Poste"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Poste.glb"></a-asset-item>
            <a-asset-item id="totodile"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/Totodile.glb"></a-asset-item>
            <a-asset-item id="cyndaquil"
                src="https://carloslajarasanchez.github.io/Models/PokemonGLT/cyndaquil.glb"></a-asset-item>
        </a-assets>

        <!-- Player -->
        <!--<a-entity id="player" position="0 1.6 0" camera look-controls wasd-controls="acceleration: 40"
            kinematic-body="shape: cylinder; radius: 0.35; height: 1.6">
            <a-cursor raycaster="objects: .clickable"></a-cursor>
        </a-entity>-->

        <a-camera id="camera" position="0 1.6 0" look-controls>
            <a-entity id="hand-slot" position="0 -0.2 -1"></a-entity>
            <a-cursor fuse="false" raycaster="objects: .clickable" cursor-grab></a-cursor>
        </a-camera>

        <!-- Entorno con ID -->
        <a-entity id="entorno" environment="
                  preset: starry;
                  lighting: sunset;
                  lightPosition: 0 0 1;
                  fog: .8;
                  shadow: true;
                  skyType: color;
                  skyColor: #88ccee;
                  horizonColor: #ffffff;
                  ground: hills;
                  groundTexture: walkernoise;
                  groundColor: #666666;
                  groundColor2: #515151;
                  stageSize: 500;
                  playArea: 200;
                  grid: none;
                  ">
        </a-entity>

        <audio id="testAudio" src="Music/Ciudad-Iris.mp3" loop></audio>

        <!--      dressing: trees;
                  dressingScale: 100;
                  dressingAmount: 2;
                  dressingColor: #3c3c3c;
        -->

        <!-- Edificios -->
        <!--Centro Pokemon -->
        <a-entity gltf-model="#CentroPokemon" position="0 0 -15" rotation="0 -90 0" scale="2 2 2" a class="clickable"
            encender-ventanas static-body="shape: hull;">
        </a-entity>
        <!-- Collider Centro Pokemon -->
        <!--<a-entity gltf-model="#CentroPokemon" position="0 -.3 -14.5" rotation="0 -90 -90" scale="2 2 2" visible="false"
            static-body="shape: hull;">
        </a-entity>-->

        <!-- Casa 1-->
        <a-entity gltf-model="#Casa" position="30 0 -15" rotation="0 0 0" scale="2 2 2" class="clickable"
            encender-ventanas>
        </a-entity>
        <!-- Collider Casa1 -->
        <!--<a-entity gltf-model="#Casa" position="30 0 -15" rotation="0 180 0" scale="2 2 2" visible="false"
            static-body="shape: hull; fit: all">
        </a-entity>-->

        <!-- Casa 2-->
        <a-entity gltf-model="#Casa" position="-30 0 -16" rotation="0 0 0" scale="2 2 2" class="clickable"
            encender-ventanas>
        </a-entity>
        <!-- Collider Casa2 -->
        <!--<a-entity gltf-model="#Casa" position="-30 0 -16" rotation="0 180 0" scale="2 2 2" visible="false"
            static-body="shape: hull; fit: all">
        </a-entity>-->

        <!-- Casa 3-->
        <a-entity gltf-model="#Casa" position="-70 0 -45" rotation="0 0 0" scale="2 2 2" class="clickable"
            encender-ventanas>
        </a-entity>
        <!-- Collider Casa3 -->
        <!--<a-entity gltf-model="#Casa" position="-70 0 -45" rotation="0 180 0" scale="2 2 2" visible="false"
            static-body="shape: hull; fit: all">
        </a-entity>-->

        <!-- Casa 4-->
        <a-entity gltf-model="#Casa" position="-70 0 -75" rotation="0 -90 0" scale="2 2 2" class="clickable"
            encender-ventanas>
        </a-entity>
        <!-- Collider Casa4 -->
        <!--<a-entity gltf-model="#Casa" position="-70 0 -75" rotation="0 -90 0" scale="2 2 2" visible="false"
            static-body="shape: hull; fit: all">
        </a-entity>-->

        <a-entity gltf-model="#Casa" position="-30 0 -75" rotation="0 -90 0" scale="2 2 2" static-body="shape: box"
            class="clickable" encender-ventanas>
        </a-entity>

        <a-entity gltf-model="#TorreQuemada" position="-70 0 -125" rotation="0 -90 0" scale="2 2 2"
            static-body="shape: box" class="clickable" encender-ventanas>
        </a-entity>

        <a-entity gltf-model="#CasaNorte" position="-11 0 -115" rotation="0 0 0" scale="2 2 2" static-body="shape: box"
            class="clickable" encender-ventanas>
        </a-entity>

        <!--<a-entity gltf-model="#Gym" position="-70 0 -20" rotation="0 -90 0" scale="1.7 2 2" static-body="shape: hull; fit: all;"
            class="clickable" encender-ventanas>
        </a-entity>-->

        <a-entity gltf-model="#Teatro" position="0 0 -43" rotation="0 -90 0" scale="2 2 2" static-body="shape: box"
            class="clickable" encender-ventanas>
        </a-entity>

        <a-entity gltf-model="#TiendaPokemon" position="30 0 -41" rotation="0 -90 0" scale="2 2 2"
            static-body="shape: box" rotar-cartel="speed: 45" class="clickable" encender-ventanas>
        </a-entity>

        <a-entity gltf-model="#Lago" position="13 .25 -100" rotation="0 -90 0" scale="2 2 2">
        </a-entity>

        <a-entity gltf-model="#Mountain" position="15 .25 -200" rotation="0 -90 0" scale="10 10 10">
        </a-entity>

        <!-- Limite atras arboles -->
        <a-entity gltf-model="#Arbol" position="-5 0 15" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 20; distancia: 5; direccion: -1 0 0">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="0 0 15" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 11; distancia: 5; direccion: 1 0 0">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="-2.5 0 20" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 20; distancia: 5; direccion: -1 0 0">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="2.5 0 20" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 11; distancia: 5; direccion: 1 0 0">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="-5 0 25" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 20; distancia: 5; direccion: -1 0 0">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="0 0 25" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 11; distancia: 5; direccion: 1 0 0">
        </a-entity>

        <!-- Limite izquiedo arboles -->
        <a-entity gltf-model="#Arbol" position="-105 0 15" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 20; distancia: 5; direccion: 0 0 -1">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="-110 0 17.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 20; distancia: 5; direccion: 0 0 -1">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="-115 0 15" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 20; distancia: 5; direccion: 0 0 -1">
        </a-entity>
        <!-- Limite derecho arboles -->
        <a-entity gltf-model="#Arbol" position="60 0 15" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 21; distancia: 5; direccion: 0 0 -1">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="65 0 17.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 21; distancia: 5; direccion: 0 0 -1">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="70 0 15" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 21; distancia: 5; direccion: 0 0 -1">
        </a-entity>

        <!-- Limite delante derecha arboles -->
        <a-entity gltf-model="#Arbol" position="55 0 -90" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 5; distancia: 5; direccion: -1 0 0">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="55 0 -85" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 4; distancia: 5; direccion: -1 0 0">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="55 0 -100" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 5; distancia: 5; direccion: -1 0 0">
        </a-entity>
        <a-entity gltf-model="#Arbol" position="57.5 0 -95" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 5; distancia: 5; direccion: -1 0 0">
        </a-entity>

        <!-- Arboles edificios-->
        <a-entity gltf-model="#Arbol" position="22 0 -17.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 1; distancia: 5; direccion: 0 0 1">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="37 0 -45" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 1; distancia: 5; direccion: 0 0 1">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="-38 0 -18.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 1; distancia: 5; direccion: 0 0 1">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="-78 0 -47.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 1; distancia: 5; direccion: 0 0 1">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="-61 0 -77.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 1; distancia: 5; direccion: 0 0 1">
        </a-entity>

        <a-entity gltf-model="#Arbol" position="-21 0 -77.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            generar-linea-arboles="cantidad: 1; distancia: 5; direccion: 0 0 1">
        </a-entity>

        <!-- Botón -->
        <a-box position="0 1 -2" depth="0.2" height="0.2" width="0.2" color="#333" class="clickable" boton-luces>
        </a-box>

        <a-entity id="pokeball" gltf-model="#Pokeball" dynamic-body="mass: 1; shape: sphere" grabbable class="clickable"
            position="0 1 -2" rotation="0 90 0" pokeball-logic>
        </a-entity>

        <!-- Lamparas -->
        <a-entity gltf-model="#Lampara" position="50 0 -80.5" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            class="clickable" generar-linea-lamparas="cantidad: 3; distancia: 3; direccion: -1 0 0" encender-ventanas>
        </a-entity>
        <!-- Lamparas casa-->
        <a-entity gltf-model="#Lampara" position="37 0 -9" rotation="0 90 0" scale="2 2 2" static-body="shape: box"
            class="clickable" encender-ventanas>
        </a-entity>
        <!-- Suelo -->
        <a-box id="suelo" position="0 -0.5 -40" width="240" height="1" depth="200" color="#7BC8A4" visible="false"
            static-body></a-box>

        <!-- Pokeball-->
        <a-entity id="pokeball" gltf-model="#pokeball" dynamic-body="mass: 1; shape: sphere" grabbable class="clickable"
            position="0 1 -2" rotation="0 90 0" pokeball-logic="stopDelay:3000; pokemonDisappearDelay:1500"
            damping="linear: .2; angular: 1">
        </a-entity>

        <!-- Pokémon -->
        <a-entity id="totodile" gltf-model="#totodile" static-body scale=".1 .1 .1" class="pokemon" position="0 0 -5"
            pingpong-move-smooth="start: 0 0 -5; end: 0 0 -10; speed: 0.02; rotSpeed: 0.02"
            capture-sound="Music/Cries-Totodile.mp3">
        </a-entity>

        <a-entity id="cyndaquil" gltf-model="#cyndaquil" static-body scale="7d 7 7" class="pokemon" position="5 0 -5"
            pingpong-move-smooth="start: 5 0 -5; end: 5 0 -10; speed: 0.02; rotSpeed: 0.02"
            capture-sound="Music/Cries-Cyndaquil.mp3" animation-mixer="clip: Fire animation; loop: repeat">
        </a-entity>

        <!-- Boton subida TODO: Implementar-->
        <a-entity id="testButton" geometry="primitive: box; width: 0.5; height: 0.2; depth: 0.1" position="0 1 5"
            unlock-button></a-entity>
    </a-scene>

    <!-- Reproducir musica -->
    <script>
        document.addEventListener('click', () => {
            document.getElementById('testAudio').play();
        });
    </script>
</body>

</html>